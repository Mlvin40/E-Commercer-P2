<div class="card p-3">
  <h5 class="mb-3">Historial de sanciones</h5>

  <div class="row g-2">
    <div class="col-md-2">
      <label class="form-label">Estado</label>
      <select class="form-select" [(ngModel)]="estado">
        <option value="">(Todos)</option>
        <option value="ACTIVA">ACTIVA</option>
        <option value="LEVANTADA">LEVANTADA</option>
      </select>
    </div>

    <div class="col-md-3">
      <label class="form-label">Buscar (usuario/correo)</label>
      <input type="search" class="form-control"
             [(ngModel)]="q" (keyup.enter)="load(0)" placeholder="nombre o correo…">
    </div>

    <div class="col-md-2">
      <label class="form-label">Desde</label>
      <input type="date" class="form-control" [(ngModel)]="desde">
    </div>
    <div class="col-md-2">
      <label class="form-label">Hasta</label>
      <input type="date" class="form-control" [(ngModel)]="hasta">
    </div>

    <div class="col-md-3 d-flex align-items-end gap-2">
      <button class="btn btn-primary" (click)="load(0)">Filtrar</button>
      <button class="btn btn-outline-secondary" (click)="q=''; estado=''; clearDates(); load(0)">Limpiar</button>
    </div>
  </div>

  <div class="mt-3" *ngIf="loading">Cargando…</div>
  <div class="text-danger mt-3" *ngIf="error">{{ error }}</div>

  <table class="table mt-3 align-middle" *ngIf="page && page.content.length">
    <thead>
      <tr>
        <th>#</th>
        <th>Fecha</th>
        <th>Usuario</th>
        <th>Correo</th>
        <th>Moderador</th>
        <th>Motivo</th>
        <th>Estado</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let s of page!.content">
        <td>#{{ s.id }}</td>
        <td>{{ s.fecha }}</td>
        <td>{{ s.usuario }}</td>
        <td>{{ s.correo }}</td>
        <td>{{ s.moderador }}</td>
        <td style="max-width: 420px">{{ s.motivo }}</td>
        <td>
          <span class="badge"
                [class.text-bg-danger]="s.estado==='ACTIVA'"
                [class.text-bg-secondary]="s.estado==='LEVANTADA'">
            {{ s.estado }}
          </span>
        </td>
      </tr>
    </tbody>
  </table>

  <div class="text-muted mt-3" *ngIf="page && !page.content.length">Sin sanciones.</div>

  <div class="d-flex align-items-center gap-3 mt-2" *ngIf="page && page.totalPages>1">
    <button class="btn btn-outline-secondary btn-sm" (click)="go(page.number-1)" [disabled]="page.number===0">Anterior</button>
    <span class="small">Página {{page.number+1}} / {{page.totalPages}}</span>
    <button class="btn btn-outline-secondary btn-sm" (click)="go(page.number+1)" [disabled]="page.number+1>=page.totalPages">Siguiente</button>
  </div>
</div>
